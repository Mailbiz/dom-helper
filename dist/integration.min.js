"use strict";!function(){function t(t){var e=typeof t;return"object"===e&&(t?t instanceof Array&&(e="array"):e="null"),e}function e(){}function n(t,n,i){var r=n.error||e,a=n.success||e,c=n.complete||e,u=function(){for(var t=null,e=0;e<p.length;e++){try{t=p[e]()}catch(t){continue}break}return t}();if(u){if(u.open(i?"POST":"GET",t,!0),i&&(u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),"object"==typeof i))try{i=Object.keys(i).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(i[t])})).join("&")}catch(t){}u.onreadystatechange=function(){4==u.readyState&&(c(),200!=u.status&&201!=u.status&&304!=u.status?r(o(u)):a(o(u)))},4!=u.readyState&&u.send(i)}}function o(t){try{return JSON.parse(t.responseText)}catch(e){return t.responseText}}function i(e){if("string"===t(e))try{var n=document.querySelectorAll(e.toString())}catch(t){}else"array"===t(e)?n=e:"object"===t(e)&&(n=[e]);return new d(n)}function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(j&&j.debug)try{console.log.apply(console,t)}catch(t){}}function a(t,e){var n=!1;return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];n||(t.apply(null,o),n=!0,setTimeout((function(){n=!1}),e))}}function c(t){if(!S&&t.email&&-1!==t.email.indexOf("@")){S=!0;var e={FormValue_ListID:t.listId,FormValue_Command:"Subscriber.Add","FormValue_Fields[UpdateifExists]":!0,"FormValue_Fields[EmailAddress]":t.email};j.nameCustomId&&t.name&&(e["FormValue_Fields[CustomField"+j.nameCustomId+"]"]=t.name),j.radioCustomId&&t.radio&&(e["FormValue_Fields[CustomField"+j.radioCustomId+"]"]=t.radio);var n=Object.keys(t.fields)||[];n&&n.length&&b(n).each((function(){var n="FormValue_Fields[CustomField"+this+"]",o=t.fields[this];"undefined"!==b.typeOf(o)&&("array"===b.typeOf(o)?b(o).each((function(t,o){e[n+"["+o+"]"]=t})):e[n]=o)})),_.setFormDataQueue(t),_.logEvent("sentData",e),b.ajax({type:"POST",url:_.getSendUrl(),data:e,complete:function(){S=!1},success:function(t){_.setFormDataQueue(null),r("mlbz enviado",t),_.logEvent("respData",t)}})}}function u(t){var e=(t=t||{}).formSelector||_.getFormSelector(),n=a(c,t.throttle);b(e).each((function(){!function(t,e){var n=b(t);t="mbzBind"+j.id;var o=n.is("[data-mbz-form]");if(n.data(t))r(n,"bind já aplicado");else{n.data(t,!0);var i={listId:o&&n.attr("data-listid")||j.listId,email:null,name:null,radio:null,fields:{}},a=o?'[data-mbz-input="email"]':_.getEmailSelector(),c=o?null:_.getNameSelector(),u=o?null:_.getRadioSelector();t=o?null:_.getSubmitSelector();var l=_.getNativeSelector();o=o?[]:_.getActiveFields()||[];var s=[],f=function(t){return b(s).each((function(){if(this&&"object"==typeof this&&this.el){var e=this.el.val();this.isExtra?(this.multiple&&(e=[],this.el.each((function(t){"object"==typeof t&&t.checked&&e.push(t.value)}))),t.fields[this.name]||null===e||(t.fields[this.name]=e)):t[this.name]||(t[this.name]=e)}})),t},p=function(t){if(t){var e=n.find(t.selector);s.push({name:t.customId,el:e,multiple:t.multiple,isExtra:!0}),e.on("change input",(function(){var n=this.value;t.multiple&&(n=[],e.each((function(t){"object"==typeof t&&t.checked&&n.push(t.value)}))),i.fields[t.customId]=n,r(i)}))}};a&&(a=n.find(a),s.push({name:"email",el:a}),a.on("change input",(function(){i.email=this.value,r(i)}))),j.nameCustomId&&c&&(c=n.find(c),s.push({name:"name",el:c}),c.on("change input",(function(){var t=this.value;"true"!=t&&"false"!=t&&(i.name=t,r(i))}))),j.radioCustomId&&u&&(u=n.find(u),s.push({name:"radio",el:u}),u.on("change input",(function(){i.radio=this.value,r(i)}))),t&&n.find(t).on("click mouseup",(function(){f(i),r("click",i),e(i)})),b(o).each((function(){p(this)})),(t=n.find(l)).length&&t.each((function(){var t=b(this),e=t.attr("data-mbz-custom-id"),o=t.attr("data-mbz-input"),a=!!t.attr("multiple")||"checkbox"===o,c="email"===o,u="date"===o||"tel"===o&&"**/**/****"===t.attr("data-mbz-mask"),l='[data-mbz-input][data-mbz-custom-id="'+e+'"]';e&&(s.push({name:e,el:a?n.find(l):t,multiple:a,isExtra:!0}),t.on("change input",(function(){var t=this.value;c?i.email=t:(u&&t&&(t=(t||"").split("/").reverse().join("-")),a&&(t=[],n.find(l).each((function(e){e&&"object"==typeof e&&e.checked&&t.push(e.value)}))),i.fields[e]=t,r(i))})))})),n.on("submit",(function(){f(i),r("submit",i),e(i)}))}}(this,n)}))}function l(){var t=this,e={tablet:function(){return navigator.userAgent.match(/Tablet|iPad|iPod/i)&&1280>=window.innerWidth},all:function(){return navigator.userAgent.match(/Android|BlackBerry|Tablet|Mobile|iPhone|iPad|iPod|Opera Mini|IEMobile/i)}};t.setDebugMode=function(t){j.debug=!!t},t.helper=_,t.log=r,t.bindElements=u,t.checkIntegration=function(){function t(t,e){t&&e&&t.each((function(t){t.style.background=e}))}var e=["#dc679e","#00ffb5","#ff006d","#ff9600","#7700ff"],n=b(_.getFormSelector());return n.each((function(){!function(n){var o=b(n);n=_.getEmailSelector();var i=_.getNameSelector(),r=_.getRadioSelector(),a=_.getSubmitSelector(),c=_.getActiveFields()||[];n&&t(o.find(n),e[0]),j.nameCustomId&&i&&t(o.find(i),e[1]),j.radioCustomId&&r&&t(o.find(r),e[2]),a&&t(o.find(a),e[3]),b(c).each((function(){t(o.find((this||{}).selector),e[2])})),t(o,e[4])}(this)})),{elements:n,hasIntegration:!!n.length}},t._mobileCheck=e,t.getDevice=function(){var t="desktop";try{e.all()&&(t=e.tablet()?"tablet":"mobile")}catch(t){}return t},t.tryParseJSON=function(t){try{return JSON.parse(t||"{}")}catch(t){}return t},t.getStorage=function(e){var n;try{return(n=localStorage.getItem(e))?t.tryParseJSON(n):n}catch(t){return r(t),n}},t.setStorage=function(t,e){try{return e="object"==typeof e?JSON.stringify(e):e,localStorage.setItem(t,e),!0}catch(t){r(t)}return!1},t.onlyNumbers=function(t){return parseInt(t.replace(/\D/g,""))}}var s,f,p=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.6.0")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],m=(s=0,f={},{set:function(t,e){var n=0;void 0===t.myCustomDataTag&&(n=s++,t.myCustomDataTag=n),f[n]=e},get:function(t){return f[t.myCustomDataTag]}}),d=function(){function t(t){this.list=[],"object"==typeof t&&(this.list=t),this.length=this.list.length}return t.prototype._applyEach=function(t){for(var e=this.list.length,n=0;n<e;++n){var o=this.list[n];try{t.call(o,o,n)}catch(t){console.error(t)}}return this},t.prototype.each=function(t){return this._applyEach(t)},t.prototype.closest=function(e){var n=this.first();return n?new t([e=n.closest(e)]):new t},t.prototype.data=function(t,e){var n,o=this.first(),i=null!==(n=m.get(o))&&void 0!==n?n:{};return t||e?void 0===e?i[t]:(i[t]=e,m.set(o,i)):i},t.prototype.on=function(t,e){return this._applyEach((function(n){n&&i(t.split(" ")).each((function(t){n.addEventListener(t,e,!1)}))}))},t.prototype.off=function(t,e){return this._applyEach((function(n){i(t.split(" ")).each((function(t){n.removeEventListener(t,e,!1)}))}))},t.prototype.is=function(t){var e=this.first();return!!e&&e.matches(t)},t.prototype.find=function(e){var n=this.first();return n&&(e=n.querySelectorAll(e)).length?new t(e):new t},t.prototype.hide=function(){return this._applyEach((function(t){t.style.display="hide"}))},t.prototype.show=function(){return this._applyEach((function(t){t.style.display="block"}))},t.prototype.hasClass=function(t){var e=this.first();return!!(e&&e.className&&new RegExp("(\\s|^)".concat(t,"(\\s|$)")).test(e.className))},t.prototype.addClass=function(t){return this._applyEach((function(e){new RegExp("(^|\\s)".concat(t,"(\\s|$)"),"g").test(e.className)||(e.className="".concat(e.className," ").concat(t).replace(/\s+/g," ").replace(/(^ | $)/g,""))}))},t.prototype.removeClass=function(t){return this._applyEach((function(e){var n=new RegExp("(^|\\s)".concat(t,"(\\s|$)"),"g");e.className=e.className.replace(n,"$1").replace(/\s+/g," ").replace(/(^ | $)/g,"")}))},t.prototype.val=function(t){var e=this.first(),n=null;return e&&(t?e.value=t.toString():n=e.value),n},t.prototype.first=function(){return 0<this.list.length?this.list[0]:null},t.prototype.attr=function(t,e){var n=this.first();if(n)return e?(n.setAttribute(t,e),this):n.getAttribute(t)},t.prototype.append=function(t){var e=this.first();if(e)return"string"==typeof t?e.innerHTML+=t.toString():e.appendChild(t),this},t.prototype.html=function(t){var e=this.first();if(e){var n=e.innerHTML;if(!t)return n;e.innerHTML=t}},t.prototype.outerHtml=function(){var t=this.first();if(t)return t.outerHTML},t.prototype.remove=function(){var t=this.first();t&&t.parentNode&&t.parentNode.removeChild(t)},t}();i.ready=function(t){if("loading"===document.readyState)return document.addEventListener("DOMContentLoaded",t);t()},i.extend=function t(e,n){for(var o in n){var i=n[o];i&&"[object Object]"===Object.prototype.toString.call(i)?(e[o]=e[o]||{},t(e[o],i)):e[o]=i}return e},i.typeOf=t,i.loadScript=function(t,e){var n=document,o=n.createElement("script");n=n.getElementsByTagName("script")[0],o.src=t,o.async=null==e||e,n.parentNode.insertBefore(o,n)},i.getQueryParameter=function(t,e){return e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&"),(t=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e))?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null},i.ajax=function(e){var o=e.url,i="string"===t(e.type)&&"post"===e.type.toLowerCase()?e.data:null;return n(o,e,i)},window._mbz_=window._mbz_||{$:{}},window._mbz_.$=i;var h=!0===window.__mbzdev__,g=h?"http://localhost:5001/api/integration/public/":"https://integration-hub.mailclick.me/server/api/integration/public/",v=h?"http://localhost:3000/static/scripts/popup.js":"https://integration-hub.mailclick.me/static/scripts/popup.min.js",y={popupHomolog:"mbz-popup"},b=window._mbz_&&window._mbz_.$?window._mbz_.$:null,S=!1,w=!1,_={},j={active:!1,integrationStatus:"",useFormAction:!1,_id:"",name:"",url:"",platform:void 0,listId:"",sendUrl:"",timeout:0,formSelector:"",emailSelector:"",nameCustomId:"",nameCustomSelector:"",radioCustomId:null,radioCustomSelector:null,submitSelector:"",extraFields:null,createdBy:"",createdAt:void 0,updatedAt:void 0,__v:0,modifiedBy:"",jqVersion:"",popups:null,formAction:void 0,debug:void 0,log:void 0,id:"",api:void 0,ready:!1,onReady:function(){}};_.throttle=a,_.logEvent=function(t,e){j.log&&j.log[t]&&j.log[t].push(e)},_.getSettingsUrl=function(){var t="";return w&&(t="?popup-homolog=true"),g+j.id+t},_.getFormSelector=function(){return j.formSelector||j.platform.formSelector||"form"},_.getEmailSelector=function(){return j.emailSelector||j.platform.emailSelector||'[type="email"], [name$="mail"]'},_.getNameSelector=function(){return j.nameCustomSelector||j.platform.nameSelector||'[placeholder*="ome"], [placeholder*="ame"], [name^="name"], [name^="Name"], [name^="nome"], [name^="Name"]'},_.getRadioSelector=function(){return j.radioCustomSelector||j.platform.radioSelector||'[type="checkbox"], [type="radio"]'},_.getSubmitSelector=function(){return j.submitSelector||j.platform.submitSelector},_.getNativeSelector=function(){return"[data-mbz-input]"},_.getSendUrl=function(){return j.useFormAction&&j.formAction&&"object"==typeof j.formAction&&j.formAction.url?j.formAction.url:j.sendUrl||"https://news.mailclick.me/subscribe.php"},_.getTimeout=function(){return j.timeout||1500},_.getFormDataQueue=function(){try{var t=j.api.getStorage("mbz-hub-queue");return t&&"object"==typeof t&&t.email?t:null}catch(t){r(t)}return!1},_.setFormDataQueue=function(t){t=t||{};try{return j.api.setStorage("mbz-hub-queue",t),!0}catch(t){r(t)}return!1},_.getActiveFields=function(){var t=[];return b(j.extraFields||[]).each((function(){var e=this||{};e&&e.active&&t.push(e)})),t};try{!function(){return b?"object"!=typeof window.MailbizIntegration?console.warn("Objeto MailbizIntegration não definido"):(j=window.MailbizIntegration).ready?r("Mailbiz - hub já foi inicializado"):j.id?("true"===b.getQueryParameter(y.popupHomolog)&&(w=!0),t=function(){var t;j.active&&j.ready&&((t=_.getFormDataQueue())&&c(t),u(),j.popups&&"object"==typeof j.popups&&(j.popups||{}).active&&b.loadScript(v),j.onReady&&"function"==typeof j.onReady&&j.onReady(j),b.ready((function(){u();var t=_.getTimeout();t&&setTimeout((function(){u()}),t)})))},void b.ajax({url:_.getSettingsUrl(),success:function(e){if(e){r("data",e);var n={log:{sentData:[],respData:[]},api:new l,popupHomolog:w};b.extend(j,n),b.extend(j,e),j.ready=!0,t&&t()}}})):r("Mailbiz - ID inválido"):r("Mailbiz - erro ao carregar _mbz_");var t}()}catch(s){}}();
